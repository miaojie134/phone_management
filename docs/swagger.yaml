definitions:
  handlers.BatchImportErrorDetail:
    properties:
      reason:
        description: 错误原因
        type: string
      rowData:
        description: 可选，原始行数据
        items:
          type: string
        type: array
      rowNumber:
        description: CSV中的原始行号 (从1开始计数，包括表头)
        type: integer
    type: object
  handlers.BatchImportMobileNumberErrorDetail:
    properties:
      reason:
        description: 错误原因
        type: string
      rowData:
        description: 可选，原始行数据
        items:
          type: string
        type: array
      rowNumber:
        description: CSV中的原始行号 (从1开始计数，包括表头)
        type: integer
    type: object
  handlers.BatchImportMobileNumbersResponse:
    properties:
      errorCount:
        type: integer
      errors:
        items:
          $ref: '#/definitions/handlers.BatchImportMobileNumberErrorDetail'
        type: array
      message:
        type: string
      successCount:
        type: integer
    type: object
  handlers.BatchImportResponse:
    properties:
      errorCount:
        type: integer
      errors:
        items:
          $ref: '#/definitions/handlers.BatchImportErrorDetail'
        type: array
      message:
        type: string
      successCount:
        type: integer
    type: object
  handlers.CreateEmployeePayload:
    properties:
      department:
        maxLength: 255
        type: string
      email:
        description: 可选，需要是合法的email格式，最大长度255
        maxLength: 255
        type: string
      fullName:
        maxLength: 255
        type: string
      hireDate:
        description: 入职日期，可选，格式 YYYY-MM-DD
        type: string
      phoneNumber:
        description: 手机号：可选，但如果提供，必须是11位数字
        type: string
    required:
    - fullName
    type: object
  handlers.CreateMobileNumberPayload:
    properties:
      applicantEmployeeId:
        description: 改为 string，代表业务工号
        type: string
      applicationDate:
        type: string
      phoneNumber:
        maxLength: 50
        type: string
      purpose:
        description: 号码用途，可选
        maxLength: 255
        type: string
      remarks:
        maxLength: 255
        type: string
      status:
        enum:
        - 闲置
        - 在用
        - 待注销
        - 已注销
        - 待核实-办卡人离职
        type: string
      vendor:
        maxLength: 100
        type: string
    required:
    - applicantEmployeeId
    - applicationDate
    - phoneNumber
    - status
    type: object
  handlers.InitiateVerificationRequest:
    properties:
      durationDays:
        maximum: 30
        minimum: 1
        type: integer
      scope:
        enum:
        - all_users
        - department
        - employee_ids
        type: string
      scopeValues:
        items:
          type: string
        type: array
    required:
    - durationDays
    - scope
    type: object
  handlers.InitiateVerificationResponse:
    properties:
      batchId:
        type: string
    type: object
  handlers.LoginRequest:
    properties:
      password:
        type: string
      username:
        type: string
    required:
    - password
    - username
    type: object
  handlers.LoginResponse:
    properties:
      token:
        type: string
      user:
        $ref: '#/definitions/handlers.UserInfo'
    type: object
  handlers.PagedEmployeesData:
    properties:
      items:
        items:
          $ref: '#/definitions/models.Employee'
        type: array
      pagination:
        $ref: '#/definitions/handlers.PaginationInfo'
    type: object
  handlers.PagedMobileNumbersData:
    properties:
      items:
        items:
          $ref: '#/definitions/models.MobileNumberResponse'
        type: array
      pagination:
        $ref: '#/definitions/handlers.PaginationInfo'
    type: object
  handlers.PaginationInfo:
    properties:
      currentPage:
        type: integer
      pageSize:
        type: integer
      totalItems:
        type: integer
      totalPages:
        type: integer
    type: object
  handlers.UserInfo:
    properties:
      role:
        type: string
      username:
        type: string
    type: object
  models.ConfirmedPhoneDetail:
    properties:
      confirmedAt:
        type: string
      confirmedBy:
        type: string
      currentUser:
        type: string
      department:
        type: string
      id:
        type: integer
      phoneNumber:
        type: string
      purpose:
        type: string
    type: object
  models.Employee:
    properties:
      createdAt:
        type: string
      deletedAt:
        format: date-time
        type: string
      department:
        description: 部门
        type: string
      email:
        description: 员工邮箱, 可选, 唯一 (NULLS NOT DISTINCT)
        type: string
      employeeId:
        description: 员工业务工号, 例如 EMP0000001
        type: string
      employmentStatus:
        description: '在职状态 (例如: ''Active'', ''Departed'')'
        type: string
      fullName:
        description: 姓名
        type: string
      hireDate:
        description: 入职日期
        type: string
      id:
        type: integer
      phoneNumber:
        description: 员工手机号码, 11位, 可选, 唯一 (NULLS NOT DISTINCT)
        type: string
      terminationDate:
        description: 离职日期
        type: string
      updatedAt:
        type: string
    type: object
  models.EmployeeDetailResponse:
    properties:
      createdAt:
        type: string
      department:
        type: string
      employeeId:
        type: string
      employmentStatus:
        type: string
      fullName:
        type: string
      handledMobileNumbers:
        description: 作为办卡人的号码列表
        items:
          $ref: '#/definitions/models.MobileNumberBasicInfo'
        type: array
      hireDate:
        type: string
      id:
        type: integer
      terminationDate:
        type: string
      updatedAt:
        type: string
      usingMobileNumbers:
        description: 作为当前使用人的号码列表
        items:
          $ref: '#/definitions/models.MobileNumberBasicInfo'
        type: array
    type: object
  models.MobileNumber:
    properties:
      applicantEmployeeId:
        description: 办卡人员工业务工号
        type: string
      applicationDate:
        type: string
      cancellationDate:
        type: string
      createdAt:
        type: string
      currentEmployeeId:
        description: 当前使用人员工业务工号
        type: string
      deletedAt:
        format: date-time
        type: string
      id:
        type: integer
      lastConfirmationDate:
        description: 最后确认日期
        type: string
      phoneNumber:
        type: string
      purpose:
        description: 号码用途，例如"办公"、"客户联系"等
        type: string
      remarks:
        maxLength: 255
        type: string
      status:
        enum:
        - 闲置
        - 在用
        - 待注销
        - 已注销
        - 待核实-办卡人离职
        - 待核实-用户报告
        type: string
      updatedAt:
        type: string
      vendor:
        maxLength: 100
        type: string
    required:
    - applicantEmployeeId
    - applicationDate
    - phoneNumber
    - status
    type: object
  models.MobileNumberAssignPayload:
    properties:
      assignmentDate:
        type: string
      employeeId:
        description: 员工业务工号
        type: string
      purpose:
        description: 号码用途，必填
        maxLength: 255
        type: string
    required:
    - assignmentDate
    - employeeId
    - purpose
    type: object
  models.MobileNumberBasicInfo:
    properties:
      id:
        type: integer
      phoneNumber:
        type: string
      status:
        type: string
    type: object
  models.MobileNumberResponse:
    properties:
      applicantEmployeeId:
        description: 办卡人员工业务工号
        type: string
      applicantName:
        description: 办卡人姓名
        type: string
      applicantStatus:
        description: 办卡人当前在职状态
        type: string
      applicationDate:
        type: string
      cancellationDate:
        type: string
      createdAt:
        type: string
      currentEmployeeId:
        description: 当前使用人员工业务工号
        type: string
      currentUserName:
        description: 当前使用人姓名
        type: string
      id:
        type: integer
      phoneNumber:
        type: string
      purpose:
        description: 号码用途
        type: string
      remarks:
        type: string
      status:
        type: string
      updatedAt:
        type: string
      usageHistory:
        description: 号码使用历史
        items:
          $ref: '#/definitions/models.NumberUsageHistory'
        type: array
      vendor:
        type: string
    type: object
  models.MobileNumberUnassignPayload:
    properties:
      reclaimDate:
        type: string
    type: object
  models.MobileNumberUpdatePayload:
    properties:
      purpose:
        maxLength: 255
        type: string
      remarks:
        maxLength: 255
        type: string
      status:
        enum:
        - 闲置
        - 在用
        - 待注销
        - 已注销
        - 待核实-办卡人离职
        - 待核实-用户报告
        type: string
      vendor:
        maxLength: 100
        type: string
    type: object
  models.NumberUsageHistory:
    properties:
      createdAt:
        type: string
      deletedAt:
        format: date-time
        type: string
      employeeId:
        description: 使用人员工业务工号
        type: string
      endDate:
        description: 使用结束日期时间
        type: string
      id:
        type: integer
      mobileNumberDbId:
        description: 手机号码记录的数据库 ID
        type: integer
      startDate:
        description: 使用开始日期时间
        type: string
      updatedAt:
        type: string
    type: object
  models.PendingUserDetail:
    properties:
      email:
        type: string
      employeeId:
        type: string
      expiresAt:
        type: string
      fullName:
        type: string
      tokenId:
        type: integer
    type: object
  models.PhoneVerificationStatusResponse:
    properties:
      confirmedPhones:
        items:
          $ref: '#/definitions/models.ConfirmedPhoneDetail'
        type: array
      pendingUsers:
        description: Reuses PendingUserDetail
        items:
          $ref: '#/definitions/models.PendingUserDetail'
        type: array
      reportedIssues:
        description: Reuses ReportedIssueDetail
        items:
          $ref: '#/definitions/models.ReportedIssueDetail'
        type: array
      summary:
        $ref: '#/definitions/models.PhoneVerificationSummary'
      unlistedNumbers:
        description: Reuses ReportedUnlistedNumberInfo
        items:
          $ref: '#/definitions/models.ReportedUnlistedNumberInfo'
        type: array
    type: object
  models.PhoneVerificationSummary:
    properties:
      confirmedPhonesCount:
        type: integer
      newlyReportedPhonesCount:
        type: integer
      pendingPhonesCount:
        type: integer
      reportedIssuesCount:
        type: integer
      totalPhonesCount:
        type: integer
    type: object
  models.ReportedIssueDetail:
    properties:
      adminActionStatus:
        type: string
      comment:
        type: string
      issueId:
        type: integer
      originalStatus:
        type: string
      phoneNumber:
        type: string
      purpose:
        type: string
      reportedAt:
        type: string
      reportedBy:
        type: string
    type: object
  models.ReportedUnlistedNumberInfo:
    properties:
      phoneNumber:
        type: string
      purpose:
        type: string
      reportedAt:
        type: string
      userComment:
        type: string
    type: object
  models.UnlistedNumber:
    properties:
      phoneNumber:
        type: string
      purpose:
        maxLength: 255
        type: string
      userComment:
        type: string
    required:
    - phoneNumber
    - purpose
    type: object
  models.UpdateEmployeePayload:
    properties:
      department:
        maxLength: 255
        type: string
      employmentStatus:
        description: 校验允许的值
        enum:
        - Active
        - Inactive
        - Departed
        type: string
      hireDate:
        description: 入职日期，格式 YYYY-MM-DD
        type: string
      terminationDate:
        description: 日期格式 YYYY-MM-DD
        type: string
    type: object
  models.VerificationBatchTask:
    properties:
      createdAt:
        type: string
      deletedAt:
        format: date-time
        type: string
      emailsAttemptedCount:
        type: integer
      emailsFailedCount:
        type: integer
      emailsSucceededCount:
        type: integer
      errorSummary:
        type: string
      id:
        type: string
      requestedDurationDays:
        type: integer
      requestedScopeType:
        $ref: '#/definitions/models.VerificationScopeType'
      requestedScopeValues:
        type: string
      status:
        $ref: '#/definitions/models.VerificationBatchTaskStatus'
      tokensGeneratedCount:
        type: integer
      totalEmployeesToProcess:
        type: integer
      updatedAt:
        type: string
    type: object
  models.VerificationBatchTaskStatus:
    enum:
    - Pending
    - InProgress
    - Completed
    - CompletedWithErrors
    - Failed
    type: string
    x-enum-varnames:
    - BatchTaskStatusPending
    - BatchTaskStatusInProgress
    - BatchTaskStatusCompleted
    - BatchTaskStatusCompletedWithErrors
    - BatchTaskStatusFailed
  models.VerificationInfo:
    properties:
      employeeId:
        type: string
      employeeName:
        type: string
      expiresAt:
        type: string
      phoneNumbers:
        items:
          $ref: '#/definitions/models.VerificationPhoneNumber'
        type: array
      previouslyReportedUnlisted:
        items:
          $ref: '#/definitions/models.ReportedUnlistedNumberInfo'
        type: array
    type: object
  models.VerificationPhoneNumber:
    properties:
      department:
        type: string
      id:
        type: integer
      phoneNumber:
        type: string
      purpose:
        type: string
      status:
        type: string
      userComment:
        type: string
    type: object
  models.VerificationScopeType:
    enum:
    - all_users
    - department
    - employee_ids
    type: string
    x-enum-varnames:
    - VerificationScopeAllUsers
    - VerificationScopeDepartment
    - VerificationScopeEmployeeIDs
  models.VerificationSubmission:
    properties:
      unlistedNumbersReported:
        items:
          $ref: '#/definitions/models.UnlistedNumber'
        type: array
      verifiedNumbers:
        items:
          $ref: '#/definitions/models.VerifiedNumber'
        type: array
    type: object
  models.VerifiedNumber:
    properties:
      action:
        enum:
        - confirm_usage
        - report_issue
        type: string
      mobileNumberId:
        type: integer
      purpose:
        type: string
      userComment:
        type: string
    required:
    - action
    - mobileNumberId
    type: object
  utils.APIErrorResponse:
    properties:
      details: {}
      error:
        type: string
    type: object
  utils.SuccessResponse:
    properties:
      data:
        description: 响应数据
      message:
        description: 可选的成功消息
        type: string
      status:
        description: 例如 "success"
        type: string
    type: object
info:
  contact: {}
paths:
  /auth/login:
    post:
      consumes:
      - application/json
      description: 验证管理员凭证并返回 JWT
      parameters:
      - description: 登录凭证
        in: body
        name: credentials
        required: true
        schema:
          $ref: '#/definitions/handlers.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 登录成功，返回 Token 和用户信息
          schema:
            allOf:
            - $ref: '#/definitions/utils.SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/handlers.LoginResponse'
              type: object
        "400":
          description: 请求参数错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "401":
          description: 无效的用户名或密码
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "500":
          description: 无法生成Token
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      summary: 管理员登录
      tags:
      - auth
  /auth/logout:
    post:
      consumes:
      - application/json
      description: Logs out the current user by invalidating their token.
      produces:
      - application/json
      responses:
        "200":
          description: 成功登出
          schema:
            $ref: '#/definitions/utils.SuccessResponse'
        "400":
          description: 错误的请求 (例如，上下文中缺少JTI或EXP)
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: User logout
      tags:
      - auth
  /employees:
    get:
      consumes:
      - application/json
      description: 根据查询参数获取员工列表，支持分页、搜索和筛选
      parameters:
      - default: 1
        description: 页码
        in: query
        name: page
        type: integer
      - default: 10
        description: 每页数量
        in: query
        name: limit
        type: integer
      - description: '排序字段 (例如: employeeId, fullName, createdAt)'
        in: query
        name: sortBy
        type: string
      - default: '"desc"'
        description: 排序顺序 ('asc'或'desc')
        in: query
        name: sortOrder
        type: string
      - description: 搜索关键词 (匹配姓名、工号)
        in: query
        name: search
        type: string
      - description: 在职状态筛选 ('Active'或'Departed')
        in: query
        name: employmentStatus
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 成功响应，包含员工列表和分页信息
          schema:
            allOf:
            - $ref: '#/definitions/utils.SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/handlers.PagedEmployeesData'
              type: object
        "400":
          description: 请求参数错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "401":
          description: 未认证或 Token 无效/过期
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取员工列表
      tags:
      - Employees
    post:
      consumes:
      - application/json
      description: 从请求体绑定数据并验证，数据保存到数据库。员工工号由系统自动生成。支持设置可选的入职日期（格式：YYYY-MM-DD）。
      parameters:
      - description: 员工信息。包含必填的姓名，可选的手机号、邮箱、部门和入职日期
        in: body
        name: employee
        required: true
        schema:
          $ref: '#/definitions/handlers.CreateEmployeePayload'
      produces:
      - application/json
      responses:
        "201":
          description: 创建成功的员工对象
          schema:
            allOf:
            - $ref: '#/definitions/utils.SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/models.Employee'
              type: object
        "400":
          description: 请求参数错误、数据校验失败或入职日期格式无效
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "401":
          description: 未认证或 Token 无效/过期
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "409":
          description: 手机号或邮箱已存在
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: 新增一个员工
      tags:
      - Employees
  /employees/{employeeId}:
    get:
      consumes:
      - application/json
      description: 根据路径参数员工业务工号获取单个员工的完整信息，包含其作为"办卡人"和"当前使用人"的号码简要列表。
      parameters:
      - description: 员工业务工号
        in: path
        name: employeeId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 成功响应，包含员工详情
          schema:
            allOf:
            - $ref: '#/definitions/utils.SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/models.EmployeeDetailResponse'
              type: object
        "400":
          description: 无效的员工工号格式 (保留，以防未来有格式校验)
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "401":
          description: 未认证或 Token 无效/过期
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "404":
          description: 员工未找到
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取指定业务工号的员工详情
      tags:
      - Employees
  /employees/{employeeId}/update:
    post:
      consumes:
      - application/json
      description: 根据员工业务工号更新员工的部门、入职日期、在职状态或离职日期。所有字段都是可选的，至少需要提供一个字段进行更新。入职日期和离职日期格式为
        YYYY-MM-DD。
      parameters:
      - description: 员工业务工号
        in: path
        name: employeeId
        required: true
        type: string
      - description: 要更新的员工字段。可包含部门、入职日期、在职状态、离职日期
        in: body
        name: employeeUpdate
        required: true
        schema:
          $ref: '#/definitions/models.UpdateEmployeePayload'
      produces:
      - application/json
      responses:
        "200":
          description: 更新后的员工对象
          schema:
            allOf:
            - $ref: '#/definitions/utils.SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/models.Employee'
              type: object
        "400":
          description: 请求参数错误、数据校验失败、日期格式无效或业务逻辑错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "401":
          description: 未认证或 Token 无效/过期
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "404":
          description: 员工未找到
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: 更新指定业务工号的员工信息
      tags:
      - Employees
  /employees/import:
    post:
      consumes:
      - multipart/form-data
      description: 通过上传 CSV 文件批量导入员工。CSV文件必须包含表头：fullName,phoneNumber,email,department,hireDate。列顺序必须一致。fullName为必填，其他字段可为空。hireDate格式为YYYY-MM-DD。支持GBK和UTF-8编码。
      parameters:
      - description: '包含员工数据的 CSV 文件。表头: fullName,phoneNumber,email,department,hireDate'
        in: formData
        name: file
        required: true
        type: file
      produces:
      - application/json
      responses:
        "200":
          description: 导入结果摘要，包含成功和失败的详细信息
          schema:
            allOf:
            - $ref: '#/definitions/utils.SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/handlers.BatchImportResponse'
              type: object
        "400":
          description: 请求错误，例如文件未提供、文件格式错误、CSV表头不匹配或数据格式错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "401":
          description: 未认证或 Token 无效/过期
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: 批量导入员工数据 (CSV)
      tags:
      - Employees
  /mobilenumbers:
    get:
      consumes:
      - application/json
      description: 根据查询参数获取手机号码列表，支持分页、搜索和筛选
      parameters:
      - default: 1
        description: 页码
        in: query
        name: page
        type: integer
      - default: 10
        description: 每页数量
        in: query
        name: limit
        type: integer
      - description: '排序字段 (例如: phoneNumber, applicationDate)'
        in: query
        name: sortBy
        type: string
      - description: 排序顺序 ('asc'或'desc')
        in: query
        name: sortOrder
        type: string
      - description: 搜索关键词 (匹配手机号、使用人、办卡人)
        in: query
        name: search
        type: string
      - description: '号码状态筛选 (例如: 闲置, 在用)'
        in: query
        name: status
        type: string
      - description: 办卡人当前在职状态筛选 ('Active'或'Departed')
        in: query
        name: applicantStatus
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 成功响应，包含号码列表和分页信息
          schema:
            allOf:
            - $ref: '#/definitions/utils.SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/handlers.PagedMobileNumbersData'
              type: object
        "400":
          description: 请求参数错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取手机号码列表
      tags:
      - MobileNumbers
    post:
      consumes:
      - application/json
      description: 从请求体绑定数据并验证，数据保存到 SQLite 的 MobileNumbers 表中，进行手机号码唯一性校验。
      parameters:
      - description: 手机号码信息 (日期格式 YYYY-MM-DD)
        in: body
        name: mobileNumber
        required: true
        schema:
          $ref: '#/definitions/handlers.CreateMobileNumberPayload'
      produces:
      - application/json
      responses:
        "201":
          description: 创建成功的号码对象
          schema:
            allOf:
            - $ref: '#/definitions/utils.SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/models.MobileNumber'
              type: object
        "400":
          description: 请求参数错误或数据校验失败
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "401":
          description: 未认证或 Token 无效/过期
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "409":
          description: 手机号码已存在
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: 新增一个手机号码
      tags:
      - MobileNumbers
  /mobilenumbers/{phoneNumber}:
    get:
      consumes:
      - application/json
      description: 根据路径参数手机号码字符串获取单个手机号码的完整信息，包括其使用历史。
      parameters:
      - description: 手机号码字符串
        in: path
        name: phoneNumber
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 成功响应，包含号码详情及其使用历史
          schema:
            allOf:
            - $ref: '#/definitions/utils.SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/models.MobileNumberResponse'
              type: object
        "400":
          description: 无效的手机号码格式 (保留，以防未来有格式校验)
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "404":
          description: 号码未找到
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取指定手机号码的详情
      tags:
      - MobileNumbers
  /mobilenumbers/{phoneNumber}/assign:
    post:
      consumes:
      - application/json
      description: 校验目标号码是否为"闲置"状态，目标员工是否为"在职"状态。更新号码记录，关联当前使用人员工ID，将号码状态改为"在用"。创建一条新的号码使用历史记录。
      parameters:
      - description: 手机号码字符串
        in: path
        name: phoneNumber
        required: true
        type: string
      - description: 分配信息 (员工业务工号和分配日期和用途 YYYY-MM-DD)
        in: body
        name: assignPayload
        required: true
        schema:
          $ref: '#/definitions/models.MobileNumberAssignPayload'
      produces:
      - application/json
      responses:
        "200":
          description: 成功分配后的号码对象
          schema:
            allOf:
            - $ref: '#/definitions/utils.SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/models.MobileNumber'
              type: object
        "400":
          description: 请求参数错误 / 无效的日期格式 / 无效的手机号码格式" // 更新了描述
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "401":
          description: 未认证或 Token 无效/过期
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "404":
          description: 手机号码或目标员工工号未找到
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "409":
          description: 操作冲突 (例如：号码非闲置，员工非在职)
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: 将指定手机号码分配给一个员工
      tags:
      - MobileNumbers
  /mobilenumbers/{phoneNumber}/unassign:
    post:
      consumes:
      - application/json
      description: 校验目标号码是否为"在用"状态。更新号码记录，清空当前使用人员工ID，将号码状态改为"闲置"。更新上一条与该号码和使用人相关的号码使用历史记录，记录使用结束时间。
      parameters:
      - description: 手机号码字符串
        in: path
        name: phoneNumber
        required: true
        type: string
      - description: 回收信息 (可选，包含回收日期 YYYY-MM-DD)
        in: body
        name: unassignPayload
        schema:
          $ref: '#/definitions/models.MobileNumberUnassignPayload'
      produces:
      - application/json
      responses:
        "200":
          description: 成功回收后的号码对象
          schema:
            allOf:
            - $ref: '#/definitions/utils.SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/models.MobileNumber'
              type: object
        "400":
          description: 请求参数错误 / 无效的日期格式 / 无效的手机号码格式" // 添加了无效手机号格式的说明
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "401":
          description: 未认证或 Token 无效/过期
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "404":
          description: 手机号码未找到
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "409":
          description: 操作冲突 (例如：号码非在用状态，或未找到有效的分配记录)
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: 从当前使用人处回收指定手机号码
      tags:
      - MobileNumbers
  /mobilenumbers/{phoneNumber}/update:
    post:
      consumes:
      - application/json
      description: 更新指定手机号码的信息 (主要用于更新状态、用途、供应商、备注)。当号码状态变更为"已注销"时，自动记录注销时间。
      parameters:
      - description: 手机号码字符串
        in: path
        name: phoneNumber
        required: true
        type: string
      - description: 要更新的手机号码字段
        in: body
        name: mobileNumberUpdate
        required: true
        schema:
          $ref: '#/definitions/models.MobileNumberUpdatePayload'
      produces:
      - application/json
      responses:
        "200":
          description: 更新后的号码对象
          schema:
            allOf:
            - $ref: '#/definitions/utils.SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/models.MobileNumber'
              type: object
        "400":
          description: 请求参数错误或数据校验失败 / 没有提供任何更新字段 / 无效的手机号码格式" // 更新了描述
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "401":
          description: 未认证或 Token 无效/过期
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "404":
          description: 号码未找到
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: 更新指定手机号码的信息
      tags:
      - MobileNumbers
  /mobilenumbers/import:
    post:
      consumes:
      - multipart/form-data
      description: 通过上传 CSV 文件批量导入手机号码。CSV文件应包含表头：phoneNumber,applicantName,applicationDate,vendor
      parameters:
      - description: '包含手机号码数据的 CSV 文件 (表头: phoneNumber,applicantName,applicationDate,vendor)'
        in: formData
        name: file
        required: true
        type: file
      produces:
      - application/json
      responses:
        "200":
          description: 导入结果摘要
          schema:
            allOf:
            - $ref: '#/definitions/utils.SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/handlers.BatchImportMobileNumbersResponse'
              type: object
        "400":
          description: 请求错误，例如文件未提供、文件格式错误或CSV表头不匹配
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "401":
          description: 未认证或 Token 无效/过期
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: 批量导入手机号码数据 (CSV)
      tags:
      - MobileNumbers
  /verification/admin/phone-status:
    get:
      consumes:
      - application/json
      description: 获取基于手机号码维度的确认流程状态，包括统计摘要和详细信息
      parameters:
      - description: 员工业务工号，用于筛选
        in: query
        name: employee_id
        type: string
      - description: 员工业务工号，用于筛选（兼容旧版本）
        in: query
        name: employeeId
        type: string
      - description: 部门名称，用于筛选
        in: query
        name: department
        type: string
      - description: 部门名称，用于筛选（兼容旧版本）
        in: query
        name: departmentName
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 成功响应
          schema:
            allOf:
            - $ref: '#/definitions/utils.SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/models.PhoneVerificationStatusResponse'
              type: object
        "400":
          description: 请求参数错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取基于手机号码维度的确认流程状态
      tags:
      - Verification
  /verification/batch/{batchId}/status:
    get:
      description: 获取指定号码确认批处理任务的当前状态、整体进度（包括已处理员工数、令牌生成情况、邮件发送统计：尝试数、成功数、失败数）以及详细的错误报告（例如邮件发送失败的原因）。
      parameters:
      - description: 批处理任务ID
        in: path
        name: batchId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 成功响应，包含批处理任务详情
          schema:
            allOf:
            - $ref: '#/definitions/utils.SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/models.VerificationBatchTask'
              type: object
        "400":
          description: 无效的批处理ID格式
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "404":
          description: 批处理任务未找到
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取号码确认批处理任务的状态
      tags:
      - Verification
  /verification/info:
    get:
      description: 用户点击邮件链接后，前端页面调用此接口获取该用户需确认的号码信息
      parameters:
      - description: 验证令牌
        in: query
        name: token
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 成功响应，包含员工姓名、令牌有效期、待验证的号码列表及其状态
          schema:
            allOf:
            - $ref: '#/definitions/utils.SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/models.VerificationInfo'
              type: object
        "403":
          description: 令牌无效或已过期
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      summary: 获取待确认的号码信息
      tags:
      - Verification
  /verification/initiate:
    post:
      consumes:
      - application/json
      description: 管理员调用此接口后，系统创建一个批处理任务来为目标员工生成 VerificationTokens 并发送邮件。接口立即返回批处理ID。
      parameters:
      - description: 请求体
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/handlers.InitiateVerificationRequest'
      produces:
      - application/json
      responses:
        "202":
          description: 请求已接受，批处理任务已创建
          schema:
            allOf:
            - $ref: '#/definitions/utils.SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/handlers.InitiateVerificationResponse'
              type: object
        "400":
          description: 请求参数无效或错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: 发起号码使用确认流程 (异步)
      tags:
      - Verification
  /verification/submit:
    post:
      consumes:
      - application/json
      description: 用户提交其号码确认结果，包括"确认使用"或"报告问题"的号码，以及可能上报的未在系统中列出但实际在使用的号码
      parameters:
      - description: 验证令牌 - 从邮件链接中获取的token参数
        in: query
        name: token
        required: true
        type: string
      - description: 请求体，包含 verifiedNumbers（必填，号码ID、动作类型、用途purpose、可选的备注）和 unlistedNumbersReported（可选，用户报告的未列出号码，需包含phoneNumber和必填的purpose）
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/models.VerificationSubmission'
      produces:
      - application/json
      responses:
        "200":
          description: 提交成功
          schema:
            $ref: '#/definitions/utils.SuccessResponse'
        "400":
          description: 请求参数无效
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "403":
          description: 令牌无效或已过期
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/utils.APIErrorResponse'
      summary: 提交号码确认结果
      tags:
      - Verification
swagger: "2.0"
